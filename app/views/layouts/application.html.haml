!!!
%html
  %head
    %title SmartQuote - Excel Processor
    %meta{name: "viewport", content: "width=device-width,initial-scale=1"}
    = csrf_meta_tags
    = csp_meta_tag
    
    = stylesheet_link_tag "application", "data-turbo-track": "reload"
    = stylesheet_link_tag "tailwind", "data-turbo-track": "reload"
    = stylesheet_link_tag "application.tailwind", "data-turbo-track": "reload"
    = javascript_importmap_tags
    = javascript_include_tag "chartkick", "Chart.bundle"
    %script{defer: true, src: "https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"}

  %body.bg-gray-100.min-h-screen
    %header{style: "background-color: #92b2d9ff; color: white;"}
      .container.mx-auto.px-4.py-0
        .flex.justify-between.items-center
          %h1.text-xl.font-bold
            = link_to image_tag("SmartQuoteLogo.png", alt: "Logo", class: "h-24 inline"), root_path
          
          %nav
            %ul.flex.space-x-4.items-center
              %li= link_to "Home", root_path, class: "hover:underline text-gray-800"
              %li= link_to "Upload file", new_file_upload_path, class: "hover:underline text-gray-800"
              
              -# References link (only for admin users)
              - if user_signed_in? && current_user.admin?
                %li= link_to "References", commodity_references_path, class: "hover:underline text-gray-800"
              
              -# Authentication section
              - if user_signed_in?
                -# Welcome message
                %li
                  %span.text-sm.text-gray-800.font-bold
                    Welcome, #{current_user.email.split('@').first.gsub('.',' ')}!
                
                -# Admin link (only for admin users)
                - if current_user.admin?
                  %li= link_to "Admin Panel", admin_users_path, class: "hover:underline text-gray-700"
                
                -# Logout link
                = button_to "Sign Out", destroy_user_session_path, method: :delete, class: "hover:underline text-gray-700 font-bold"

              
              - else
                -# Login link
                %li= link_to "Sign In", new_user_session_path, class: "hover:underline text-gray-700"

    %main
      - if notice
        .container.mx-auto.px-4.mt-4
          .bg-orange-600.text-black.px-4.py-3.rounded.relative.mb-4
            = notice
      
      - if alert
        .container.mx-auto.px-4.mt-4
          .bg-orange-500.text-black.px-4.py-3.rounded.relative.mb-4
            = alert
      
      = yield

    .w-full
      %footer{style: "background-color: #101920; color: white; margin-top: 2rem;"}
        .container.mx-auto.px-4.py-8.max-w-sm
          %p.text-center.text-gray-400.text-sm
            SmartQuote - Excel Processor &copy; #{Date.current.year}