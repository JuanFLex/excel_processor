#!/bin/bash

# Script para mostrar logs de demo en tiempo real
echo "ğŸ¬ Starting DEMO log visualization..."
echo "ğŸ“º Showing demonstration messages only..."
echo "ğŸ¯ Press Ctrl+C to stop"
echo ""
echo "==========================================="
echo ""

# Verificar si el archivo de log existe
if [ ! -f "log/development.log" ]; then
    echo "âŒ Error: log/development.log not found"
    echo "Make sure you're running this from the Rails root directory"
    exit 1
fi

# Mostrar logs filtrados con colores
tail -f log/development.log | grep --line-buffered "\[DEMO\]" | while read line; do
    # Extraer la fecha/hora del log
    timestamp=$(echo "$line" | cut -d' ' -f1-2)
    # Extraer el mensaje sin la fecha
    message=$(echo "$line" | sed 's/.*\[DEMO\]/[DEMO]/')
    
    # Colorear los diferentes tipos de mensajes
    if echo "$message" | grep -q "ERROR\|âŒ"; then
        echo -e "\033[31m[$timestamp] $message\033[0m"  # Rojo para errores
    elif echo "$message" | grep -q "âœ…\|ğŸ‰\|âœ¨"; then
        echo -e "\033[32m[$timestamp] $message\033[0m"  # Verde para Ã©xitos
    elif echo "$message" | grep -q "ğŸ¤–\|ğŸ§ \|ğŸš€"; then
        echo -e "\033[33m[$timestamp] $message\033[0m"  # Amarillo para AI
    elif echo "$message" | grep -q "ğŸ¯\|ğŸ“Š\|ğŸ’¾"; then
        echo -e "\033[36m[$timestamp] $message\033[0m"  # Cyan para procesamiento
    elif echo "$message" | grep -q "âš¡\|ğŸ”„\|ğŸ”"; then
        echo -e "\033[35m[$timestamp] $message\033[0m"  # Magenta para optimizaciÃ³n
    else
        echo -e "[$timestamp] $message"  # Normal para otros
    fi
done